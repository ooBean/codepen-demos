<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cat Laser Chase</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            background-color: #1a1a1a;
            cursor: none;
            overflow: hidden;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: sans-serif;
        }

        .laser-dot {
            position: absolute;
            width: 15px;
            height: 15px;
            background-color: red;
            border-radius: 50%;
            box-shadow: 0 0 15px 5px red;
            transform: translate(-50%, -50%);
            pointer-events: none;
            opacity: 0;
            /* Initially hidden */
            transition: opacity 0.2s;
        }

        .cat {
            position: absolute;
            width: 80px;
            height: 80px;
            transform: translate(-50%, -50%);
            pointer-events: none;
            transition: transform 0.1s linear;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        .info {
            z-index: 10;
        }
    </style>
</head>

<body>

    <div class="info">Move your mouse to see the cats chase the laser!</div>
    <div class="laser-dot"></div>

    <script>
        const laserDot = document.querySelector('.laser-dot');
        const cats = [];
        const numCats = 16; // Display all 16 cats
        const easingFactors = [0.05, 0.15, 0.08, 0.12, 0.07, 0.14, 0.1, 0.06, 0.13, 0.09, 0.11, 0.04, 0.16, 0.03, 0.1, 0.08];
        const safetyDistances = [80, 100, 120, 90, 110, 130, 140, 85, 105, 125, 95, 115, 135, 145, 75, 150];
        const catImages = [
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-1.png',
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-2.png',
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-3.png',
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-4.png',
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-5.png',
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-6.png',
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-7.png',
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-8.png',
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-9.png',
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-10.png',
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-11.png',
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-12.png',
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-13.png',
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-14.png',
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-15.png',
            'https://raw.githubusercontent.com/ooBean/AssetHub/main/cats/cat-16.png',
        ];

        let mouseX = window.innerWidth / 2;
        let mouseY = window.innerHeight / 2;
        let isChasing = false; // Add state to track mouse presence

        // Create cats
        for (let i = 0; i < numCats; i++) {
            const catElement = document.createElement('div');
            catElement.className = 'cat';

            catElement.style.backgroundImage = `url('${catImages[i]}')`;
            document.body.appendChild(catElement);

            const margin = 100; // Outer margin from page edges
            const centerMargin = 200; // Margin from the center of the screen

            let startX, startY;

            // Decide which quadrant to place the cat in
            const quadrant = Math.random();

            if (quadrant < 0.5) { // Place on the left or right side
                startX = Math.random() < 0.5 ?
                    Math.random() * (window.innerWidth / 2 - centerMargin) + margin : // Left side
                    Math.random() * (window.innerWidth / 2 - centerMargin) + window.innerWidth / 2 + centerMargin; // Right side
                startY = Math.random() * (window.innerHeight - 2 * margin) + margin;
            } else { // Place on the top or bottom side
                startX = Math.random() * (window.innerWidth - 2 * margin) + margin;
                startY = Math.random() < 0.5 ?
                    Math.random() * (window.innerHeight / 2 - centerMargin) + margin : // Top side
                    Math.random() * (window.innerHeight / 2 - centerMargin) + window.innerHeight / 2 + centerMargin; // Bottom side
            }

            // Clamp values to be within the screen bounds
            startX = Math.max(margin, Math.min(startX, window.innerWidth - margin));
            startY = Math.max(margin, Math.min(startY, window.innerHeight - margin));

            cats.push({
                element: catElement,
                x: startX,
                y: startY,
                vx: 0,
                vy: 0,
                easing: easingFactors[i],
                safetyDistance: safetyDistances[i],
                targetX: startX, // Add target for scattering
                targetY: startY,
                swayTime: Math.random() * 100 // Add a timer for the sway effect
            });

            // Set initial static position
            catElement.style.left = `${startX}px`;
            catElement.style.top = `${startY}px`;
        }

        window.addEventListener('mousemove', (e) => {
            mouseX = e.clientX;
            mouseY = e.clientY;
            document.querySelector('.info').style.display = 'none';
        });

        document.body.addEventListener('mouseenter', () => {
            laserDot.style.opacity = 1;
            isChasing = true;
        });

        document.body.addEventListener('mouseleave', () => {
            laserDot.style.opacity = 0;
            isChasing = false;
            // Assign new random targets for scattering
            cats.forEach(cat => {
                const margin = 100;
                cat.targetX = Math.random() * (window.innerWidth - 2 * margin) + margin;
                cat.targetY = Math.random() * (window.innerHeight - 2 * margin) + margin;
            });
        });

        function animate() {
            // Move laser dot
            laserDot.style.left = `${mouseX}px`;
            laserDot.style.top = `${mouseY}px`;

            cats.forEach((cat, i) => {
                let targetX, targetY;
                if (isChasing) {
                    targetX = mouseX;
                    targetY = mouseY;
                } else {
                    targetX = cat.targetX;
                    targetY = cat.targetY;
                }

                // --- Start of New Physics-Based Movement ---

                // 1. Attraction force towards the target
                let attractDx = targetX - cat.x;
                let attractDy = targetY - cat.y;
                let distanceToTarget = Math.sqrt(attractDx * attractDx + attractDy * attractDy);

                // When chasing, if a cat is inside its safety distance, the attraction becomes repulsion.
                if (isChasing && distanceToTarget < cat.safetyDistance) {
                    const repulsionStrength = 1 - distanceToTarget / cat.safetyDistance;
                    attractDx = -attractDx * repulsionStrength;
                    attractDy = -attractDy * repulsionStrength;
                }

                // 2. Separation force from other cats
                let separateDx = 0;
                let separateDy = 0;
                const separationDistance = 70; // Give them a bit more personal space

                cats.forEach((otherCat, j) => {
                    if (i !== j) {
                        const dx = cat.x - otherCat.x;
                        const dy = cat.y - otherCat.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);

                        if (distance > 0 && distance < separationDistance) {
                            const force = 1 - (distance / separationDistance);
                            separateDx += (dx / distance) * force;
                            separateDy += (dy / distance) * force;
                        }
                    }
                });

                // 3. Combine forces
                const attractionStrength = 0.08;
                const separationStrength = 1.1;

                let forceX = attractDx * attractionStrength + separateDx * separationStrength;
                let forceY = attractDy * attractionStrength + separateDy * separationStrength;

                // 4. Apply force to velocity
                cat.vx += forceX * cat.easing;
                cat.vy += forceY * cat.easing;

                // 5. Apply damping (friction)
                const damping = 0.9; // A bit less damping to feel more 'slippery'
                cat.vx *= damping;
                cat.vy *= damping;

                // 6. Update position based on velocity
                if (!isChasing && distanceToTarget < 2) {
                    // Stop completely when scattered and at the target
                    cat.vx = 0;
                    cat.vy = 0;
                } else {
                    cat.x += cat.vx;
                    cat.y += cat.vy;
                }

                // --- End of New Physics-Based Movement ---


                // Angle towards the movement direction (now based on velocity)
                const angle = Math.atan2(cat.vy, cat.vx) * (180 / Math.PI);

                // Add sway effect when moving
                let sway = 0;
                const speed = Math.sqrt(cat.vx * cat.vx + cat.vy * cat.vy);
                if (speed > 0.1) { // Only sway if the cat is moving significantly
                    cat.swayTime += speed * 0.05; // Sway speed depends on cat's speed
                    sway = Math.sin(cat.swayTime) * 10; // 10 is the sway amplitude
                }

                cat.element.style.left = `${cat.x}px`;
                cat.element.style.top = `${cat.y}px`;
                cat.element.style.transform = `translate(-50%, -50%) rotate(calc(${angle}deg + 90deg)) translateX(${sway}px)`;
            });

            requestAnimationFrame(animate);
        }

        animate();
    </script>

</body>

</html>